"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const mockDb = {
    getItem: async (tableName, key) => {
        console.log(`Mock DB: Getting item from ${tableName} with key`, key);
        // Return mock data based on the table and key
        if (tableName === 'Pallets' && key.codigo === '123456789001') {
            return {
                codigo: '123456789001',
                estado: 'open',
                cajas: [],
                cantidadCajas: 0,
                fechaCreacion: '2023-04-21T15:30:00Z',
                ubicacion: 'TRANSITO'
            };
        }
        return undefined;
    },
    putItem: async (tableName, item) => {
        console.log(`Mock DB: Putting item in ${tableName}:`, item);
        return { success: true };
    },
    updateItem: async (tableName, key, updateExpression, expressionAttributeValues, expressionAttributeNames) => {
        console.log(`Mock DB: Updating item in ${tableName} with key`, key);
        console.log('Update expression:', updateExpression);
        console.log('Expression attribute values:', expressionAttributeValues);
        // For the movePallet operation, return a mock updated pallet
        if (tableName === 'Pallets' && key.codigo === '123456789001') {
            return {
                codigo: '123456789001',
                estado: 'open',
                cajas: [],
                cantidadCajas: 0,
                fechaCreacion: '2023-04-21T15:30:00Z',
                ubicacion: expressionAttributeValues[':location'],
                updatedAt: expressionAttributeValues[':updatedAt']
            };
        }
        return {};
    },
    deleteItem: async (tableName, key) => {
        console.log(`Mock DB: Deleting item from ${tableName} with key`, key);
        return { success: true };
    },
    queryItems: async (tableName, keyConditionExpression, expressionAttributeValues, expressionAttributeNames, indexName) => {
        console.log(`Mock DB: Querying items from ${tableName}`);
        console.log('Key condition expression:', keyConditionExpression);
        console.log('Expression attribute values:', expressionAttributeValues);
        // Return empty array as default
        return [];
    },
    scanItems: async (tableName, filterExpression, expressionAttributeValues, expressionAttributeNames) => {
        console.log(`Mock DB: Scanning items from ${tableName}`);
        if (filterExpression)
            console.log('Filter expression:', filterExpression);
        // Return empty array as default
        return [];
    }
};
// Create a wrapper that matches the DynamoDB Document Client interface
const mockDynamoDb = {
    get: async (params) => {
        return {
            Item: await mockDb.getItem(params.TableName, params.Key)
        };
    },
    put: async (params) => {
        return await mockDb.putItem(params.TableName, params.Item);
    },
    update: async (params) => {
        const { TableName, Key, UpdateExpression, ExpressionAttributeValues, ExpressionAttributeNames } = params;
        const Attributes = await mockDb.updateItem(TableName, Key, UpdateExpression, ExpressionAttributeValues, ExpressionAttributeNames);
        return { Attributes };
    },
    delete: async (params) => {
        return await mockDb.deleteItem(params.TableName, params.Key);
    },
    query: async (params) => {
        const { TableName, KeyConditionExpression, ExpressionAttributeValues, ExpressionAttributeNames, IndexName } = params;
        const Items = await mockDb.queryItems(TableName, KeyConditionExpression, ExpressionAttributeValues, ExpressionAttributeNames, IndexName);
        return { Items };
    },
    scan: async (params) => {
        const Items = await mockDb.scanItems(params.TableName, params.FilterExpression, params.ExpressionAttributeValues, params.ExpressionAttributeNames);
        return { Items };
    }
};
exports.default = mockDynamoDb;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9ja0RiLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vdXRpbHMvbW9ja0RiLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBdUJBLE1BQU0sTUFBTSxHQUFHO0lBQ2IsT0FBTyxFQUFFLEtBQUssRUFBRSxTQUFpQixFQUFFLEdBQXdCLEVBQXFDLEVBQUU7UUFDaEcsT0FBTyxDQUFDLEdBQUcsQ0FBQyw4QkFBOEIsU0FBUyxXQUFXLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDckUsOENBQThDO1FBQzlDLElBQUksU0FBUyxLQUFLLFNBQVMsSUFBSSxHQUFHLENBQUMsTUFBTSxLQUFLLGNBQWMsRUFBRSxDQUFDO1lBQzdELE9BQU87Z0JBQ0wsTUFBTSxFQUFFLGNBQWM7Z0JBQ3RCLE1BQU0sRUFBRSxNQUFNO2dCQUNkLEtBQUssRUFBRSxFQUFFO2dCQUNULGFBQWEsRUFBRSxDQUFDO2dCQUNoQixhQUFhLEVBQUUsc0JBQXNCO2dCQUNyQyxTQUFTLEVBQUUsVUFBVTthQUN0QixDQUFDO1FBQ0osQ0FBQztRQUNELE9BQU8sU0FBUyxDQUFDO0lBQ25CLENBQUM7SUFFRCxPQUFPLEVBQUUsS0FBSyxFQUFFLFNBQWlCLEVBQUUsSUFBa0IsRUFBaUMsRUFBRTtRQUN0RixPQUFPLENBQUMsR0FBRyxDQUFDLDRCQUE0QixTQUFTLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUM1RCxPQUFPLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxDQUFDO0lBQzNCLENBQUM7SUFFRCxVQUFVLEVBQUUsS0FBSyxFQUNmLFNBQWlCLEVBQ2pCLEdBQXdCLEVBQ3hCLGdCQUF3QixFQUN4Qix5QkFBOEMsRUFDOUMsd0JBQWlELEVBQzFCLEVBQUU7UUFDekIsT0FBTyxDQUFDLEdBQUcsQ0FBQyw2QkFBNkIsU0FBUyxXQUFXLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDcEUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDO1FB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QUFTLEVBQUUsTUFBTSxDQUFDLEdBQUksQ0FBQyxDQUFDO0lBQ2hFLENBQUM7SUFFRCxLQUFLLEVBQUUsS0FBSyxFQUFFLE1BQW9CLEVBQXNDLEVBQUU7UUFDeEUsTUFBTSxFQUNKLFNBQVMsRUFDVCxzQkFBc0IsRUFDdEIseUJBQXlCLEVBQ3pCLHdCQUF3QixFQUN4QixTQUFTLEVBQ1YsR0FBRyxNQUFNLENBQUM7UUFFWCxNQUFNLEtBQUssR0FBRyxNQUFNLE1BQU0sQ0FBQyxVQUFVLENBQ25DLFNBQVMsRUFDVCxzQkFBdUIsRUFDdkIseUJBQTBCLEVBQzFCLHdCQUF3QixFQUN4QixTQUFTLENBQ1YsQ0FBQztRQUVGLE9BQU8sRUFBRSxLQUFLLEVBQUUsQ0FBQztJQUNuQixDQUFDO0lBRUQsSUFBSSxFQUFFLEtBQUssRUFBRSxNQUFvQixFQUFzQyxFQUFFO1FBQ3ZFLE1BQU0sS0FBSyxHQUFHLE1BQU0sTUFBTSxDQUFDLFNBQVMsQ0FDbEMsTUFBTSxDQUFDLFNBQVMsRUFDaEIsTUFBTSxDQUFDLGdCQUFnQixFQUN2QixNQUFNLENBQUMseUJBQXlCLEVBQ2hDLE1BQU0sQ0FBQyx3QkFBd0IsQ0FDaEMsQ0FBQztRQUVGLE9BQU8sRUFBRSxLQUFLLEVBQUUsQ0FBQztJQUNuQixDQUFDO0NBQ0YsQ0FBQztBQUVGLGtCQUFlLFlBQVksQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IER5bmFtb0RiSXRlbSwgUGFsbGV0IH0gZnJvbSAnLi4vdHlwZXMnO1xuXG5pbnRlcmZhY2UgRHluYW1vUGFyYW1zIHtcbiAgVGFibGVOYW1lOiBzdHJpbmc7XG4gIEtleT86IFJlY29yZDxzdHJpbmcsIGFueT47XG4gIFVwZGF0ZUV4cHJlc3Npb24/OiBzdHJpbmc7XG4gIEV4cHJlc3Npb25BdHRyaWJ1dGVWYWx1ZXM/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuICBFeHByZXNzaW9uQXR0cmlidXRlTmFtZXM/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuICBJdGVtPzogRHluYW1vRGJJdGVtO1xuICBQcm9qZWN0aW9uRXhwcmVzc2lvbj86IHN0cmluZztcbiAgRmlsdGVyRXhwcmVzc2lvbj86IHN0cmluZztcbiAgS2V5Q29uZGl0aW9uRXhwcmVzc2lvbj86IHN0cmluZztcbiAgSW5kZXhOYW1lPzogc3RyaW5nO1xuICBSZXR1cm5WYWx1ZXM/OiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBEeW5hbW9SZXNwb25zZSB7XG4gIEl0ZW0/OiBEeW5hbW9EYkl0ZW07XG4gIEl0ZW1zPzogRHluYW1vRGJJdGVtW107XG4gIEF0dHJpYnV0ZXM/OiBEeW5hbW9EYkl0ZW07XG4gIExhc3RFdmFsdWF0ZWRLZXk/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xufVxuXG5jb25zdCBtb2NrRGIgPSB7XG4gIGdldEl0ZW06IGFzeW5jICh0YWJsZU5hbWU6IHN0cmluZywga2V5OiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogUHJvbWlzZTxEeW5hbW9EYkl0ZW0gfCB1bmRlZmluZWQ+ID0+IHtcbiAgICBjb25zb2xlLmxvZyhgTW9jayBEQjogR2V0dGluZyBpdGVtIGZyb20gJHt0YWJsZU5hbWV9IHdpdGgga2V5YCwga2V5KTtcbiAgICAvLyBSZXR1cm4gbW9jayBkYXRhIGJhc2VkIG9uIHRoZSB0YWJsZSBhbmQga2V5XG4gICAgaWYgKHRhYmxlTmFtZSA9PT0gJ1BhbGxldHMnICYmIGtleS5jb2RpZ28gPT09ICcxMjM0NTY3ODkwMDEnKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb2RpZ286ICcxMjM0NTY3ODkwMDEnLFxuICAgICAgICBlc3RhZG86ICdvcGVuJyxcbiAgICAgICAgY2FqYXM6IFtdLFxuICAgICAgICBjYW50aWRhZENhamFzOiAwLFxuICAgICAgICBmZWNoYUNyZWFjaW9uOiAnMjAyMy0wNC0yMVQxNTozMDowMFonLFxuICAgICAgICB1YmljYWNpb246ICdUUkFOU0lUTydcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH0sXG5cbiAgcHV0SXRlbTogYXN5bmMgKHRhYmxlTmFtZTogc3RyaW5nLCBpdGVtOiBEeW5hbW9EYkl0ZW0pOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbiB9PiA9PiB7XG4gICAgY29uc29sZS5sb2coYE1vY2sgREI6IFB1dHRpbmcgaXRlbSBpbiAke3RhYmxlTmFtZX06YCwgaXRlbSk7XG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICB9LFxuXG4gIHVwZGF0ZUl0ZW06IGFzeW5jIChcbiAgICB0YWJsZU5hbWU6IHN0cmluZywgXG4gICAga2V5OiBSZWNvcmQ8c3RyaW5nLCBhbnk+LCBcbiAgICB1cGRhdGVFeHByZXNzaW9uOiBzdHJpbmcsIFxuICAgIGV4cHJlc3Npb25BdHRyaWJ1dGVWYWx1ZXM6IFJlY29yZDxzdHJpbmcsIGFueT4sIFxuICAgIGV4cHJlc3Npb25BdHRyaWJ1dGVOYW1lcz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbiAgKTogUHJvbWlzZTxEeW5hbW9EYkl0ZW0+ID0+IHtcbiAgICBjb25zb2xlLmxvZyhgTW9jayBEQjogVXBkYXRpbmcgaXRlbSBpbiAke3RhYmxlTmFtZX0gd2l0aCBrZXlgLCBrZXkpO1xuICAgIGNvbnNvbGUubG9nKCdVcGRhdGUgZXhwcmVzc2lvbjonLCB1cGRhdGVFeHByZXNzaW9uKTtcbiAgICBjb25zb2xlLmxvZygnRXhwcmVzc2lvbiBhdHRyaWJ1dGUgdmFsdWVzOicsIGV4cHJlc3Npb25BdHRyaWJ1dGVWYWx1ZXMpO1xuICAgIFxuICAgIC8vIEZvciB0aGUgbW92ZVBhbGxldCBvcGVyYXRpb24sIHJldHVybiBhIG1vY2sgdXBkYXRlZCBwYWxsZXRcbiAgICBpZiAodGFibGVOYW1lID09PSAnUGFsbGV0cycgJiYga2V5LmNvZGlnbyA9PT0gJzEyMzQ1Njc4OTAwMScpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvZGlnbzogJzEyMzQ1Njc4OTAwMScsXG4gICAgICAgIGVzdGFkbzogJ29wZW4nLFxuICAgICAgICBjYWphczogW10sXG4gICAgICAgIGNhbnRpZGFkQ2FqYXM6IDAsXG4gICAgICAgIGZlY2hhQ3JlYWNpb246ICcyMDIzLTA0LTIxVDE1OjMwOjAwWicsXG4gICAgICAgIHViaWNhY2lvbjogZXhwcmVzc2lvbkF0dHJpYnV0ZVZhbHVlc1snOmxvY2F0aW9uJ10sXG4gICAgICAgIHVwZGF0ZWRBdDogZXhwcmVzc2lvbkF0dHJpYnV0ZVZhbHVlc1snOnVwZGF0ZWRBdCddXG4gICAgICB9O1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge307XG4gIH0sXG5cbiAgZGVsZXRlSXRlbTogYXN5bmMgKHRhYmxlTmFtZTogc3RyaW5nLCBrZXk6IFJlY29yZDxzdHJpbmcsIGFueT4pOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbiB9PiA9PiB7XG4gICAgY29uc29sZS5sb2coYE1vY2sgREI6IERlbGV0aW5nIGl0ZW0gZnJvbSAke3RhYmxlTmFtZX0gd2l0aCBrZXlgLCBrZXkpO1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcbiAgfSxcblxuICBxdWVyeUl0ZW1zOiBhc3luYyAoXG4gICAgdGFibGVOYW1lOiBzdHJpbmcsIFxuICAgIGtleUNvbmRpdGlvbkV4cHJlc3Npb246IHN0cmluZywgXG4gICAgZXhwcmVzc2lvbkF0dHJpYnV0ZVZhbHVlczogUmVjb3JkPHN0cmluZywgYW55PiwgXG4gICAgZXhwcmVzc2lvbkF0dHJpYnV0ZU5hbWVzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPixcbiAgICBpbmRleE5hbWU/OiBzdHJpbmdcbiAgKTogUHJvbWlzZTxEeW5hbW9EYkl0ZW1bXT4gPT4ge1xuICAgIGNvbnNvbGUubG9nKGBNb2NrIERCOiBRdWVyeWluZyBpdGVtcyBmcm9tICR7dGFibGVOYW1lfWApO1xuICAgIGNvbnNvbGUubG9nKCdLZXkgY29uZGl0aW9uIGV4cHJlc3Npb246Jywga2V5Q29uZGl0aW9uRXhwcmVzc2lvbik7XG4gICAgY29uc29sZS5sb2coJ0V4cHJlc3Npb24gYXR0cmlidXRlIHZhbHVlczonLCBleHByZXNzaW9uQXR0cmlidXRlVmFsdWVzKTtcbiAgICBcbiAgICAvLyBSZXR1cm4gZW1wdHkgYXJyYXkgYXMgZGVmYXVsdFxuICAgIHJldHVybiBbXTtcbiAgfSxcblxuICBzY2FuSXRlbXM6IGFzeW5jIChcbiAgICB0YWJsZU5hbWU6IHN0cmluZywgXG4gICAgZmlsdGVyRXhwcmVzc2lvbj86IHN0cmluZywgXG4gICAgZXhwcmVzc2lvbkF0dHJpYnV0ZVZhbHVlcz86IFJlY29yZDxzdHJpbmcsIGFueT4sXG4gICAgZXhwcmVzc2lvbkF0dHJpYnV0ZU5hbWVzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPlxuICApOiBQcm9taXNlPER5bmFtb0RiSXRlbVtdPiA9PiB7XG4gICAgY29uc29sZS5sb2coYE1vY2sgREI6IFNjYW5uaW5nIGl0ZW1zIGZyb20gJHt0YWJsZU5hbWV9YCk7XG4gICAgaWYgKGZpbHRlckV4cHJlc3Npb24pIGNvbnNvbGUubG9nKCdGaWx0ZXIgZXhwcmVzc2lvbjonLCBmaWx0ZXJFeHByZXNzaW9uKTtcbiAgICBcbiAgICAvLyBSZXR1cm4gZW1wdHkgYXJyYXkgYXMgZGVmYXVsdFxuICAgIHJldHVybiBbXTtcbiAgfVxufTtcblxuLy8gQ3JlYXRlIGEgd3JhcHBlciB0aGF0IG1hdGNoZXMgdGhlIER5bmFtb0RCIERvY3VtZW50IENsaWVudCBpbnRlcmZhY2VcbmNvbnN0IG1vY2tEeW5hbW9EYiA9IHtcbiAgZ2V0OiBhc3luYyAocGFyYW1zOiBEeW5hbW9QYXJhbXMpOiBQcm9taXNlPHsgSXRlbT86IER5bmFtb0RiSXRlbSB9PiA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIEl0ZW06IGF3YWl0IG1vY2tEYi5nZXRJdGVtKHBhcmFtcy5UYWJsZU5hbWUsIHBhcmFtcy5LZXkhKVxuICAgIH07XG4gIH0sXG4gIFxuICBwdXQ6IGFzeW5jIChwYXJhbXM6IER5bmFtb1BhcmFtcyk6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuIH0+ID0+IHtcbiAgICByZXR1cm4gYXdhaXQgbW9ja0RiLnB1dEl0ZW0ocGFyYW1zLlRhYmxlTmFtZSwgcGFyYW1zLkl0ZW0hKTtcbiAgfSxcbiAgXG4gIHVwZGF0ZTogYXN5bmMgKHBhcmFtczogRHluYW1vUGFyYW1zKTogUHJvbWlzZTx7IEF0dHJpYnV0ZXM/OiBEeW5hbW9EYkl0ZW0gfT4gPT4ge1xuICAgIGNvbnN0IHsgVGFibGVOYW1lLCBLZXksIFVwZGF0ZUV4cHJlc3Npb24sIEV4cHJlc3Npb25BdHRyaWJ1dGVWYWx1ZXMsIEV4cHJlc3Npb25BdHRyaWJ1dGVOYW1lcyB9ID0gcGFyYW1zO1xuICAgIGNvbnN0IEF0dHJpYnV0ZXMgPSBhd2FpdCBtb2NrRGIudXBkYXRlSXRlbShcbiAgICAgIFRhYmxlTmFtZSwgXG4gICAgICBLZXkhLCBcbiAgICAgIFVwZGF0ZUV4cHJlc3Npb24hLCBcbiAgICAgIEV4cHJlc3Npb25BdHRyaWJ1dGVWYWx1ZXMhLCBcbiAgICAgIEV4cHJlc3Npb25BdHRyaWJ1dGVOYW1lc1xuICAgICk7XG4gICAgcmV0dXJuIHsgQXR0cmlidXRlcyB9O1xuICB9LFxuICBcbiAgZGVsZXRlOiBhc3luYyAocGFyYW1zOiBEeW5hbW9QYXJhbXMpOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbiB9PiA9PiB7XG4gICAgcmV0dXJuIGF3YWl0IG1vY2tEYi5kZWxldGVJdGVtKHBhcmFtcy5UYWJsZU5hbWUsIHBhcmFtcy5LZXkhKTtcbiAgfSxcbiAgXG4gIHF1ZXJ5OiBhc3luYyAocGFyYW1zOiBEeW5hbW9QYXJhbXMpOiBQcm9taXNlPHsgSXRlbXM6IER5bmFtb0RiSXRlbVtdIH0+ID0+IHtcbiAgICBjb25zdCB7IFxuICAgICAgVGFibGVOYW1lLCBcbiAgICAgIEtleUNvbmRpdGlvbkV4cHJlc3Npb24sIFxuICAgICAgRXhwcmVzc2lvbkF0dHJpYnV0ZVZhbHVlcywgXG4gICAgICBFeHByZXNzaW9uQXR0cmlidXRlTmFtZXMsXG4gICAgICBJbmRleE5hbWVcbiAgICB9ID0gcGFyYW1zO1xuICAgIFxuICAgIGNvbnN0IEl0ZW1zID0gYXdhaXQgbW9ja0RiLnF1ZXJ5SXRlbXMoXG4gICAgICBUYWJsZU5hbWUsIFxuICAgICAgS2V5Q29uZGl0aW9uRXhwcmVzc2lvbiEsIFxuICAgICAgRXhwcmVzc2lvbkF0dHJpYnV0ZVZhbHVlcyEsIFxuICAgICAgRXhwcmVzc2lvbkF0dHJpYnV0ZU5hbWVzLFxuICAgICAgSW5kZXhOYW1lXG4gICAgKTtcbiAgICBcbiAgICByZXR1cm4geyBJdGVtcyB9O1xuICB9LFxuICBcbiAgc2NhbjogYXN5bmMgKHBhcmFtczogRHluYW1vUGFyYW1zKTogUHJvbWlzZTx7IEl0ZW1zOiBEeW5hbW9EYkl0ZW1bXSB9PiA9PiB7XG4gICAgY29uc3QgSXRlbXMgPSBhd2FpdCBtb2NrRGIuc2Nhbkl0ZW1zKFxuICAgICAgcGFyYW1zLlRhYmxlTmFtZSxcbiAgICAgIHBhcmFtcy5GaWx0ZXJFeHByZXNzaW9uLFxuICAgICAgcGFyYW1zLkV4cHJlc3Npb25BdHRyaWJ1dGVWYWx1ZXMsXG4gICAgICBwYXJhbXMuRXhwcmVzc2lvbkF0dHJpYnV0ZU5hbWVzXG4gICAgKTtcbiAgICBcbiAgICByZXR1cm4geyBJdGVtcyB9O1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBtb2NrRHluYW1vRGI7ICJdfQ==